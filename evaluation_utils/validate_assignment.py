from pathlib import Path

def is_valid_assignment(assign_str):
    seen = set()
    for lit_str in assign_str.split():
        lit = int(lit_str)
        var = abs(lit)
        if var in seen:
            # same variable appears twice with different signs
            return False
        seen.add(var)
    return True

def parse_assignment(assign_str):
    """Convert assignment string to a dictionary var -> True/False"""
    assignment = {}
    for lit_str in assign_str.split():
        lit = int(lit_str)
        if lit == 0:
            continue
        assignment[abs(lit)] = (lit > 0)
    return assignment

def check_dimacs_satisfaction(cnf_file, assign_str):
    assignment = parse_assignment(assign_str)
    
    with open(cnf_file) as f:
        clause_num = 0
        for line in f:
            line = line.strip()
            if not line or line.startswith('c') or line.startswith('p'):
                continue
            clause_num += 1
            literals = list(map(int, line.split()))
            clause_satisfied = False
            for lit in literals:
                if lit == 0:
                    break
                var = abs(lit)
                val = assignment[var]
                if (lit > 0 and val) or (lit < 0 and not val):
                    clause_satisfied = True
                    break
            if not clause_satisfied:
                return False, clause_num, literals  # failing clause
    return True, None, None  # all clauses satisfied

if __name__ == "__main__":
    assignment = "-1079 -1077 -1073 -1071 -1070 -1068 -1067 -1066 -1062 -1058 -1057 -1053 -1051 -1050 -1048 -1046 -1044 -1043 -1042 -1033 -1018 -1016 -1008 -1007 -1002 -999 -998 -996 -994 -993 -992 -990 -989 -988 -983 -982 -980 -979 -978 -977 -976 -975 -974 -971 -967 -966 -964 -963 -962 -958 -953 -952 -951 -944 -943 -942 -940 -937 -936 -935 -931 -930 -928 -926 -923 -922 -917 -914 -912 -911 -906 -905 -903 -902 -897 -895 -894 -892 -891 -889 -888 -887 -884 -879 -875 -870 -869 -865 -864 -863 -861 -858 -857 -854 -852 -848 -846 -844 -842 -838 -836 -835 -833 -830 -829 -824 -821 -820 -814 -812 -807 -806 -803 -798 -796 -795 -794 -792 -791 -788 -785 -782 -779 -777 -775 -772 -771 -770 -769 -767 -766 -765 -762 -758 -757 -755 -754 -752 -750 -748 -746 -745 -738 -737 -736 -735 -733 -731 -730 -729 -722 -717 -715 -712 -709 -707 -704 -703 -700 -698 -696 -695 -693 -692 -689 -688 -683 -682 -681 -680 -675 -672 -670 -665 -663 -662 -661 -660 -656 -653 -649 -648 -647 -646 -645 -644 -642 -641 -640 -639 -634 -628 -626 -622 -619 -617 -616 -612 -611 -610 -608 -607 -606 -603 -601 -597 -595 -594 -593 -592 -590 -588 -587 -586 -583 -580 -578 -575 -573 -570 -566 -565 -564 -563 -561 -559 -555 -554 -552 -550 -549 -548 -547 -545 -541 -540 -537 -534 -533 -531 -529 -528 -527 -524 -521 -520 -518 -514 -511 -509 -505 -504 -501 -500 -497 -496 -491 -486 -485 -484 -483 -482 -477 -475 -473 -471 -470 -466 -464 -462 -461 -456 -454 -448 -447 -445 -440 -435 -432 -430 -427 -425 -421 -414 -413 -412 -411 -410 -401 -400 -399 -394 -389 -388 -383 -381 -377 -372 -371 -368 -366 -365 -363 -362 -360 -356 -355 -354 -350 -345 -343 -339 -338 -335 -334 -333 -330 -329 -328 -326 -325 -323 -321 -319 -318 -311 -310 -309 -297 -295 -294 -293 -291 -290 -288 -287 -280 -279 -278 -267 -266 -265 -261 -257 -256 -255 -250 -249 -247 -242 -241 -236 -235 -231 -228 -227 -224 -222 -221 -217 -210 -206 -204 -196 -193 -192 -188 -187 -185 -182 -181 -180 -176 -163 -157 -155 -151 -149 -141 -140 -137 -134 -126 -123 -121 -120 -117 -116 -115 -109 -105 -101 -100 -99 -97 -88 -72 -70 -65 -49 -44 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 45 46 47 48 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 66 67 68 69 71 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 89 90 91 92 93 94 95 96 98 102 103 104 106 107 108 110 111 112 113 114 118 119 122 124 125 127 128 129 130 131 132 133 135 136 138 139 142 143 144 145 146 147 148 150 152 153 154 156 158 159 160 161 162 164 165 166 167 168 169 170 171 172 173 174 175 177 178 179 183 184 186 189 190 191 194 195 197 198 199 200 201 202 203 205 207 208 209 211 212 213 214 215 216 218 219 220 223 225 226 229 230 232 233 234 237 238 239 240 243 244 245 246 248 251 252 253 254 258 259 260 262 263 264 268 269 270 271 272 273 274 275 276 277 281 282 283 284 285 286 289 292 296 298 299 300 301 302 303 304 305 306 307 308 312 313 314 315 316 317 320 322 324 327 331 332 336 337 340 341 342 344 346 347 348 349 351 352 353 357 358 359 361 364 367 369 370 373 374 375 376 378 379 380 382 384 385 386 387 390 391 392 393 395 396 397 398 402 403 404 405 406 407 408 409 415 416 417 418 419 420 422 423 424 426 428 429 431 433 434 436 437 438 439 441 442 443 444 446 449 450 451 452 453 455 457 458 459 460 463 465 467 468 469 472 474 476 478 479 480 481 487 488 489 490 492 493 494 495 498 499 502 503 506 507 508 510 512 513 515 516 517 519 522 523 525 526 530 532 535 536 538 539 542 543 544 546 551 553 556 557 558 560 562 567 568 569 571 572 574 576 577 579 581 582 584 585 589 591 596 598 599 600 602 604 605 609 613 614 615 618 620 621 623 624 625 627 629 630 631 632 633 635 636 637 638 643 650 651 652 654 655 657 658 659 664 666 667 668 669 671 673 674 676 677 678 679 684 685 686 687 690 691 694 697 699 701 702 705 706 708 710 711 713 714 716 718 719 720 721 723 724 725 726 727 728 732 734 739 740 741 742 743 744 747 749 751 753 756 759 760 761 763 764 768 773 774 776 778 780 781 783 784 786 787 789 790 793 797 799 800 801 802 804 805 808 809 810 811 813 815 816 817 818 819 822 823 825 826 827 828 831 832 834 837 839 840 841 843 845 847 849 850 851 853 855 856 859 860 862 866 867 868 871 872 873 874 876 877 878 880 881 882 883 885 886 890 893 896 898 899 900 901 904 907 908 909 910 913 915 916 918 919 920 921 924 925 927 929 932 933 934 938 939 941 945 946 947 948 949 950 954 955 956 957 959 960 961 965 968 969 970 972 973 981 984 985 986 987 991 995 997 1000 1001 1003 1004 1005 1006 1009 1010 1011 1012 1013 1014 1015 1017 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1034 1035 1036 1037 1038 1039 1040 1041 1045 1047 1049 1052 1054 1055 1056 1059 1060 1061 1063 1064 1065 1069 1072 1074 1075 1076 1078 1080"
    print(is_valid_assignment(assignment))
    print(check_dimacs_satisfaction(Path("examples/easy/unsat/0033baadbd48d3f880e9b5a733bd4950-rope_0030.shuffled.cnf"), assignment))


